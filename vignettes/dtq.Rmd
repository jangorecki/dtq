
## Queries logging

```{r}
# options("dtq.log"=TRUE) # default
dt <- data.table(a=rep(1:4),b=rep(letters[1:2],2))
dt[a < 100L, .(a,b)
   ][i = b %in% c(letters[1:2]), mean_a_by_b := mean(a), b
     ][, c("a5","ab5") := lapply(.SD, `+`, 5L), .SDcols = -c("b")
       ][]
dt[, by = .(b), lapply(.SD,sum), .SDcols=c("a")
   ][b %in% c("a","b"), mean(a)]

dt <- dtt() # dtt(purge=TRUE)
options("dtq.log"=FALSE)

dt
dt[, c(.SD, rbindlist(lapply(dtq, function(x) x$process())))]
dt[, c(.SD, rbindlist(lapply(dtq, function(x) x$process(chain=TRUE))))]

# compact
dt[, c(.SD, rbindlist(lapply(dtq, function(x) x$process())))
   ][, .(dtq_depth = dtq_seq[.N],
         timestamp = timestamp[.N],
         env = env[.N],
         elapsed = sum(elapsed),
         query = paste(query,collapse="")),
     .(dtq_id)]

dtt(chain.only=TRUE)
```


## Read-only data.table

```{r read_only}
dt <- data.table(a = 1L)
dt[, a := 2L]
print(dt)
  
dt <- data.table(a = 1L)
setattr(dt,"read.only",TRUE)
dt[, a := 2L]
print(dt)
```
